<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIO SHOOTER 2D - Tactical Shooter</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Auth Screen -->
        <div id="auth-screen" class="auth-screen">
            <div class="auth-card">
                <div class="auth-title">SIO SHOOTER 2D</div>
                <div class="auth-subtitle">Tactical FPS - Style Valorant</div>
                
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')">Connexion</button>
                    <button class="auth-tab" onclick="switchAuthTab('register')">Inscription</button>
                </div>
                
                <form id="login-form" class="auth-form">
                    <div class="form-group">
                        <input type="email" id="login-email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="login-password" placeholder="Mot de passe" required>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-sign-in-alt"></i> Se connecter
                    </button>
                </form>

                <form id="register-form" class="auth-form hidden">
                    <div class="form-group">
                        <input type="text" id="register-username" placeholder="Nom d'utilisateur" required>
                    </div>
                    <div class="form-group">
                        <input type="email" id="register-email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="register-password" placeholder="Mot de passe" required>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-user-plus"></i> S'inscrire
                    </button>
                </form>

                <div class="social-auth">
                    <button class="google-btn" onclick="signInWithGoogle()">
                        <i class="fab fa-google"></i> Continuer avec Google
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="main-menu" class="main-menu hidden">
            <div class="menu-header">
                <div class="logo">SIO SHOOTER 2D</div>
                <div class="user-info">
                    <div class="user-avatar" onclick="openPlayerProfile()" title="Cliquez pour voir votre profil" style="cursor: pointer;">
                        <i class="fas fa-user" id="user-avatar-icon"></i>
                    </div>
                    <div class="user-details">
                        <div class="username" id="current-username">Joueur</div>
                        <div class="user-rank" id="current-user-rank">Rang: Fer I</div>
                        <div class="user-currency">
                            <span class="currency-item">
                                <i class="fas fa-coins"></i> <span id="header-coins">1000</span>
                            </span>
                            <span class="currency-item">
                                <i class="fas fa-gem"></i> <span id="header-vp">0</span>
                            </span>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>

            <div class="menu-content">
                <div class="sidebar">
                    <nav class="menu-nav">
                        <button class="nav-btn active" onclick="showMenuSection('play')">
                            <i class="fas fa-play"></i> Jouer
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('friends')">
                            <i class="fas fa-users"></i> Amis
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('leaderboard')">
                            <i class="fas fa-trophy"></i> Classements
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('store')">
                            <i class="fas fa-shopping-cart"></i> Boutique
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('battlepass')">
                            <i class="fas fa-layer-group"></i> Battle Pass
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('tournament')">
                            <i class="fas fa-trophy"></i> Tournois
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('inventory')">
                            <i class="fas fa-box-open"></i> Inventaire
                        </button>
                        <button class="nav-btn" onclick="showMenuSection('settings')">
                            <i class="fas fa-cog"></i> Paramètres
                        </button>
                    </nav>
                </div>

                <div class="main-content">
                    <!-- Play Section -->
                    <div id="play-section" class="menu-section">
                        <h2>Modes de Jeu</h2>
                        <div class="game-modes">
                            <div class="game-mode" onclick="selectGameMode('competitive')">
                                <div class="mode-icon"><i class="fas fa-trophy"></i></div>
                                <div class="mode-info">
                                    <h3>Compétitif</h3>
                                    <p>5v5 classé - Premier à 13 rounds</p>
                                    <div class="mode-details">
                                        <span class="detail-badge ranked">Classé</span>
                                        <span class="detail-badge">Économie</span>
                                    </div>
                                </div>
                            </div>

                            <div class="game-mode" onclick="selectGameMode('duel')">
                                <div class="mode-icon"><i class="fas fa-sword"></i></div>
                                <div class="mode-info">
                                    <h3>Duel</h3>
                                    <p>1v1 - Premier à 5 rounds</p>
                                    <div class="mode-details">
                                        <span class="detail-badge ranked">Classé</span>
                                        <span class="detail-badge">Économie</span>
                                    </div>
                                </div>
                            </div>

                            <div class="game-mode" onclick="selectGameMode('attack_defense')">
                                <div class="mode-icon"><i class="fas fa-shield-alt"></i></div>
                                <div class="mode-info">
                                    <h3>Attaque / Défense</h3>
                                    <p>5v5 tactique avec changement de camp</p>
                                    <div class="mode-details">
                                        <span class="detail-badge">Objectif</span>
                                        <span class="detail-badge">Économie</span>
                                    </div>
                                </div>
                            </div>

                            <div class="game-mode" onclick="selectGameMode('unrated')">
                                <div class="mode-icon"><i class="fas fa-gamepad"></i></div>
                                <div class="mode-info">
                                    <h3>Non classé</h3>
                                    <p>5v5 casual - Entraînement</p>
                                    <div class="mode-details">
                                        <span class="detail-badge">Casual</span>
                                        <span class="detail-badge">Économie</span>
                                    </div>
                                </div>
                            </div>

                            <div class="game-mode" onclick="selectGameMode('deathmatch')">
                                <div class="mode-icon"><i class="fas fa-crosshairs"></i></div>
                                <div class="mode-info">
                                    <h3>Deathmatch</h3>
                                    <p>Combat libre - 10 minutes</p>
                                    <div class="mode-details">
                                        <span class="detail-badge">Action</span>
                                        <span class="detail-badge">Pas d'économie</span>
                                    </div>
                                </div>
                            </div>

                            <div class="game-mode" onclick="selectGameMode('training')">
                                <div class="mode-icon"><i class="fas fa-dumbbell"></i></div>
                                <div class="mode-info">
                                    <h3>Entraînement</h3>
                                    <p>Solo avec bots personnalisables</p>
                                    <div class="mode-details">
                                        <span class="detail-badge">Solo</span>
                                        <span class="detail-badge">Bots</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="map-selection">
                            <h3>Sélection de Carte</h3>
                            <div class="maps-grid">
                                <div class="map-card active" onclick="selectMap('haven')">
                                    <div class="map-preview haven"></div>
                                    <div class="map-info">
                                        <div class="map-name">Haven</div>
                                        <div class="map-layout">3 sites</div>
                                    </div>
                                </div>
                                <div class="map-card" onclick="selectMap('ascent')">
                                    <div class="map-preview ascent"></div>
                                    <div class="map-info">
                                        <div class="map-name">Ascent</div>
                                        <div class="map-layout">2 sites</div>
                                    </div>
                                </div>
                                <div class="map-card" onclick="selectMap('bind')">
                                    <div class="map-preview bind"></div>
                                    <div class="map-info">
                                        <div class="map-name">Bind</div>
                                        <div class="map-layout">2 sites</div>
                                    </div>
                                </div>
                                <div class="map-card" onclick="selectMap('auto')">
                                    <div class="map-preview auto"></div>
                                    <div class="map-info">
                                        <div class="map-name">Automatique</div>
                                        <div class="map-layout">Aléatoire</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="play-options">
                            <div class="play-settings">
                                <h4>Préférences</h4>
                                <div class="setting-row">
                                    <label>Région:</label>
                                    <select id="region-select">
                                        <option value="EU">Europe</option>
                                        <option value="NA">Amérique du Nord</option>
                                        <option value="AS">Asie</option>
                                    </select>
                                </div>
                                <div class="setting-row">
                                    <label>Ping max:</label>
                                    <select id="ping-select">
                                        <option value="50">50ms</option>
                                        <option value="100" selected>100ms</option>
                                        <option value="150">150ms</option>
                                    </select>
                                </div>
                            </div>

                        </div>

                        <div class="selected-agent-info" style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 10px; padding: 15px; margin-top: 20px; text-align: center;">
                            <h4 style="color: #00d4ff; margin-bottom: 10px;">
                                <i class="fas fa-user-ninja"></i> Agent sélectionné
                            </h4>
                            <div id="current-agent-display"></div>
                            <p style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 10px;">
                                Changez d'agent dans <strong>Inventaire > Agents</strong>
                            </p>
                        </div>

                        <button class="launch-game-btn" onclick="launchGame()" style="margin-top: 20px;">
                            <i class="fas fa-rocket"></i> RECHERCHER UNE PARTIE
                        </button>
                    </div>

                    <!-- Friends Section -->
                    <div id="friends-section" class="menu-section hidden">
                        <h2>Liste d'Amis</h2>
                        <div class="friends-actions">
                            <div class="add-friend">
                                <input type="text" id="friend-username" placeholder="Nom d'utilisateur" maxlength="20">
                                <button onclick="addFriend()"><i class="fas fa-user-plus"></i></button>
                            </div>
                            <div class="friends-search">
                                <input type="text" id="friend-search" placeholder="Rechercher dans vos amis..." onkeyup="searchFriends(this.value)">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <div class="friends-list" id="friends-list">
                            <!-- Friends will be loaded here -->
                        </div>
                    </div>

                    <!-- Leaderboard Section -->
                    <div id="leaderboard-section" class="menu-section hidden">
                        <h2>Classements</h2>
                        <div class="leaderboard-tabs">
                            <button class="leaderboard-tab active" onclick="switchLeaderboardTab('competitive')">Compétitif</button>
                            <button class="leaderboard-tab" onclick="switchLeaderboardTab('duel')">Duel</button>
                            <button class="leaderboard-tab" onclick="switchLeaderboardTab('kills')">Éliminations</button>
                            <button class="leaderboard-tab" onclick="switchLeaderboardTab('level')">Niveau</button>
                        </div>
                        <div class="leaderboard-content" id="leaderboard-content">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i> Chargement du classement...
                            </div>
                        </div>
                    </div>

                    <!-- Store Section -->
                    <div id="store-section" class="menu-section hidden">
                        <h2>Boutique</h2>
                        <div class="currency-display">
                            <div class="currency-item">
                                <i class="fas fa-coins"></i>
                                <span id="user-coins">1000</span> SIO Coins
                            </div>
                            <div class="currency-item">
                                <i class="fas fa-gem"></i>
                                <span id="user-vp">0</span> VP
                            </div>
                        </div>

                        <div class="store-tabs">
                            <button class="store-tab active" data-store-tab="cases" onclick="switchStoreTab('cases', this)">Cases</button>
                            <button class="store-tab" data-store-tab="skins" onclick="switchStoreTab('skins', this)">Skins</button>
                            <button class="store-tab" data-store-tab="agents" onclick="switchStoreTab('agents', this)">Agents</button>
                        </div>

                        <div id="store-cases" class="store-content">
                            <div class="cases-grid" id="cases-grid">
                                <!-- Cases will be loaded here -->
                            </div>
                        </div>

                        <div id="store-skins" class="store-content hidden">
                            <div class="skin-categories">
                                <button class="skin-cat active" onclick="showSkinCategory('rifles')">Fusils</button>
                                <button class="skin-cat" onclick="showSkinCategory('pistols')">Pistolets</button>
                                <button class="skin-cat" onclick="showSkinCategory('smgs')">SMG</button>
                                <button class="skin-cat" onclick="showSkinCategory('snipers')">Snipers</button>
                                <button class="skin-cat" onclick="showSkinCategory('knives')">Couteaux</button>
                            </div>
                            <div class="skins-grid" id="skins-grid">
                                <!-- Skins will be loaded here -->
                            </div>
                        </div>

                        <div id="store-agents" class="store-content hidden">
                            <div class="agents-grid" id="agents-grid">
                                <!-- Agents will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Battle Pass Section -->
                    <div id="battlepass-section" class="menu-section hidden">
                        <h2>Battle Pass</h2>
                        <div class="battlepass-layout">
                            <div class="battlepass-summary" id="battlepass-summary"></div>
                            <div class="battlepass-progress-wrapper">
                                <div class="battlepass-progress" id="battlepass-progress"></div>
                            </div>
                            <div class="battlepass-tracks">
                                <div class="battlepass-track" id="battlepass-free">
                                    <div class="track-header">
                                        <h3>Piste gratuite</h3>
                                        <span class="track-label free">Disponible pour tous</span>
                                    </div>
                                    <div class="battlepass-track-grid" id="battlepass-free-track"></div>
                                </div>
                                <div class="battlepass-track premium" id="battlepass-premium">
                                    <div class="track-header">
                                        <h3>Piste premium</h3>
                                        <span class="track-label premium">Réservée Premium</span>
                                    </div>
                                    <div class="battlepass-track-grid" id="battlepass-premium-track"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tournament Section -->
                    <div id="tournament-section" class="menu-section hidden">
                        <div class="tournament-header">
                            <div>
                                <h2>Tournois</h2>
                                <p>Rejoignez une compétition ou créez votre propre bracket.</p>
                            </div>
                            <button class="btn-primary" id="create-tournament-btn">
                                <i class="fas fa-plus"></i> Nouveau tournoi
                            </button>
                        </div>

                        <div class="tournament-create-card hidden" id="tournament-create-card">
                            <div class="create-grid">
                                <div class="input-group">
                                    <label for="tournament-name">Nom du tournoi</label>
                                    <input type="text" id="tournament-name" placeholder="Ex: Cup SIO #1" maxlength="40">
                                </div>
                                <div class="input-group">
                                    <label for="tournament-size">Participants</label>
                                    <select id="tournament-size">
                                        <option value="4">4 joueurs</option>
                                        <option value="8" selected>8 joueurs</option>
                                        <option value="16">16 joueurs</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label for="tournament-mode">Mode</label>
                                    <select id="tournament-mode">
                                        <option value="duel">Duel 1v1</option>
                                        <option value="competitive">Compétitif 5v5</option>
                                    </select>
                                </div>
                            </div>
                            <div class="create-actions">
                                <button class="btn-secondary" id="cancel-tournament-create">Annuler</button>
                                <button class="btn-primary" id="confirm-tournament-create">Créer</button>
                            </div>
                        </div>

                        <div class="tournament-content">
                            <div class="tournament-list" id="tournament-list">
                                <!-- Tournois dynamiques -->
                            </div>
                            <div class="tournament-details" id="tournament-details">
                                <div class="tournament-placeholder">
                                    <i class="fas fa-trophy"></i>
                                    <p>Sélectionnez un tournoi pour afficher les détails.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Section -->
                    <div id="inventory-section" class="menu-section hidden">
                        <h2>Inventaire</h2>
                        <div class="inventory-stats">
                            <div class="inventory-stat">
                                <span class="stat-label">Skins possédés:</span>
                                <span class="stat-value" id="total-skins">0</span>
                            </div>
                            <div class="inventory-stat">
                                <span class="stat-label">Valeur totale:</span>
                                <span class="stat-value" id="total-value">0</span> SIO Coins
                            </div>
                        </div>

                        <div class="inventory-tabs">
                            <button class="inventory-tab active" data-inventory-tab="weapons" onclick="switchInventoryTab('weapons', this)">Armes</button>
                            <button class="inventory-tab" data-inventory-tab="agents" onclick="switchInventoryTab('agents', this)">Agents</button>
                            <button class="inventory-tab" data-inventory-tab="cases" onclick="switchInventoryTab('cases', this)">Cases</button>
                        </div>

                        <div id="inventory-weapons" class="inventory-content">
                            <div class="weapon-categories">
                                <button class="weapon-cat active" onclick="showInventoryCategory('rifles')">Fusils</button>
                                <button class="weapon-cat" onclick="showInventoryCategory('pistols')">Pistolets</button>
                                <button class="weapon-cat" onclick="showInventoryCategory('smgs')">SMG</button>
                                <button class="weapon-cat" onclick="showInventoryCategory('snipers')">Snipers</button>
                                <button class="weapon-cat" onclick="showInventoryCategory('knives')">Couteaux</button>
                            </div>
                            <div class="inventory-grid" id="inventory-weapons-grid">
                                <!-- Owned weapon skins will be loaded here -->
                            </div>
                        </div>

                        <div id="inventory-agents" class="inventory-content hidden">
                            <div class="inventory-grid" id="inventory-agents-grid">
                                <!-- Owned agents will be loaded here -->
                            </div>
                        </div>

                        <div id="inventory-cases" class="inventory-content hidden">
                            <div class="inventory-grid" id="inventory-cases-grid">
                                <!-- Owned cases will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section -->
                    <div id="settings-section" class="menu-section hidden">
                        <h2>Paramètres</h2>
                        <div class="settings-categories">
                            <div class="setting-group">
                                <h3>Audio</h3>
                                <div class="setting-item">
                                    <label>Volume Principal</label>
                                    <input type="range" min="0" max="100" value="50" data-setting="masterVolume">
                                    <span class="volume-value">50%</span>
                                </div>
                                <div class="setting-item">
                                    <label>Effets Sonores</label>
                                    <input type="range" min="0" max="100" value="70" data-setting="effectsVolume">
                                    <span class="volume-value">70%</span>
                                </div>
                            </div>
                            <div class="setting-group">
                                <h3>Graphiques</h3>
                                <div class="setting-item">
                                    <label>Qualité</label>
                                    <select data-setting="graphics">
                                        <option value="low">Basse</option>
                                        <option value="medium" selected>Moyenne</option>
                                        <option value="high">Haute</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <label>FPS cible</label>
                                    <select data-setting="targetFPS">
                                        <option value="60" selected>60 FPS</option>
                                        <option value="120">120 FPS</option>
                                        <option value="144">144 FPS</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-group">
                                <h3>Contrôles</h3>
                                <div class="setting-item">
                                    <label>Sensibilité Souris</label>
                                    <input type="range" min="1" max="10" value="5" data-setting="mouseSensitivity">
                                    <span class="sensitivity-value">5</span>
                                </div>
                                <div class="setting-item">
                                    <label>Mode de visée</label>
                                    <select data-setting="aimMode">
                                        <option value="hold">Maintenir</option>
                                        <option value="toggle">Basculer</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-group">
                                <h3>Interface</h3>
                                <div class="setting-item">
                                    <label>Afficher les dégâts</label>
                                    <input type="checkbox" data-setting="showDamage" checked>
                                </div>
                                <div class="setting-item">
                                    <label>Kill feed étendu</label>
                                    <input type="checkbox" data-setting="extendedKillFeed" checked>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Modal -->
        <div id="profile-modal" class="modal-overlay hidden">
            <div class="profile-modal">
                <div class="profile-header">
                    <div class="profile-avatar-container">
                        <div class="profile-avatar">
                            <i class="fas fa-user" id="profile-avatar-icon"></i>
                        </div>
                        <div class="profile-status" id="profile-status">
                            <i class="fas fa-circle"></i> En ligne
                        </div>
                    </div>
                    <div class="profile-info">
                        <h2 id="profile-username">Nom d'utilisateur</h2>
                        <div class="profile-rank" id="profile-rank">Rang: Fer I</div>
                        <div class="profile-level" id="profile-level">Niveau 1 (0/1000 XP)</div>
                    </div>
                    <button class="modal-close" onclick="closeProfileModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="profile-content">
                    <div class="profile-tabs">
                        <button class="profile-tab active" onclick="switchProfileTab('stats')">
                            <i class="fas fa-chart-bar"></i> Statistiques
                        </button>
                        <button class="profile-tab" onclick="switchProfileTab('achievements')">
                            <i class="fas fa-trophy"></i> Succès
                        </button>
                        <button class="profile-tab" onclick="switchProfileTab('matches')" id="profile-matches-tab">
                            <i class="fas fa-history"></i> Historique
                        </button>
                        <button class="profile-tab" onclick="switchProfileTab('settings')" id="profile-settings-tab" style="display: none;">
                            <i class="fas fa-cog"></i> Paramètres
                        </button>
                    </div>

                    <!-- Stats Tab -->
                    <div id="profile-stats-content" class="profile-tab-content">
                        <div class="stats-overview">
                            <div class="stat-card highlight">
                                <div class="stat-icon"><i class="fas fa-crosshairs"></i></div>
                                <div class="stat-info">
                                    <div class="stat-value" id="stat-kills">0</div>
                                    <div class="stat-label">Éliminations</div>
                                </div>
                            </div>
                            <div class="stat-card highlight">
                                <div class="stat-icon"><i class="fas fa-skull"></i></div>
                                <div class="stat-info">
                                    <div class="stat-value" id="stat-deaths">0</div>
                                    <div class="stat-label">Morts</div>
                                </div>
                            </div>
                            <div class="stat-card highlight">
                                <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                                <div class="stat-info">
                                    <div class="stat-value" id="stat-wins">0</div>
                                    <div class="stat-label">Victoires</div>
                                </div>
                            </div>
                            <div class="stat-card highlight">
                                <div class="stat-icon"><i class="fas fa-target"></i></div>
                                <div class="stat-info">
                                    <div class="stat-value" id="stat-accuracy">0%</div>
                                    <div class="stat-label">Précision</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-detailed">
                            <h3>Statistiques par mode</h3>
                            <div class="mode-stats">
                                <div class="mode-stat-card">
                                    <h4>Compétitif</h4>
                                    <div class="mode-stats-grid">
                                        <div class="stat-row">
                                            <span>Rang:</span>
                                            <span id="competitive-rank">Fer I</span>
                                        </div>
                                        <div class="stat-row">
                                            <span>Parties:</span>
                                            <span id="competitive-games">0</span>
                                        </div>
                                        <div class="stat-row">
                                            <span>Ratio V/D:</span>
                                            <span id="competitive-winrate">0%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mode-stat-card">
                                    <h4>Duel</h4>
                                    <div class="mode-stats-grid">
                                        <div class="stat-row">
                                            <span>Rang:</span>
                                            <span id="duel-rank">Fer I</span>
                                        </div>
                                        <div class="stat-row">
                                            <span>Parties:</span>
                                            <span id="duel-games">0</span>
                                        </div>
                                        <div class="stat-row">
                                            <span>Ratio V/D:</span>
                                            <span id="duel-winrate">0%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Achievements Tab -->
                    <div id="profile-achievements-content" class="profile-tab-content hidden">
                        <div class="achievements-header">
                            <h3>Succès débloqués</h3>
                            <div class="achievements-progress">
                                <span id="achievements-count">0/0</span>
                            </div>
                        </div>
                        <div class="achievements-grid" id="achievements-grid">
                            <!-- Achievements will be loaded here -->
                        </div>
                    </div>

                    <!-- Match History Tab -->
                    <div id="profile-matches-content" class="profile-tab-content hidden">
                        <div class="match-history">
                            <h3>Historique des parties</h3>
                            <div class="match-filters">
                                <select id="match-mode-filter">
                                    <option value="all">Tous les modes</option>
                                    <option value="competitive">Compétitif</option>
                                    <option value="duel">Duel</option>
                                    <option value="unrated">Non classé</option>
                                    <option value="deathmatch">Deathmatch</option>
                                </select>
                            </div>
                            <div class="matches-list" id="matches-list">
                                <!-- Match history will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Profile Settings Tab -->
                    <div id="profile-settings-content" class="profile-tab-content hidden">
                        <div class="profile-settings">
                            <h3>Modifier le profil</h3>
                            
                            <div class="setting-group">
                                <label>Nom d'utilisateur</label>
                                <div class="username-edit">
                                    <input type="text" id="edit-username" placeholder="Nouveau nom d'utilisateur" maxlength="20">
                                    <button onclick="updateUsername()" class="update-btn">
                                        <i class="fas fa-save"></i> Sauvegarder
                                    </button>
                                </div>
                                <small>Le nom doit contenir entre 3 et 20 caractères</small>
                            </div>

                            <div class="setting-group">
                                <label>Avatar</label>
                                <div class="avatar-selection">
                                    <div class="avatar-option active" data-avatar="user" onclick="selectAvatar('user')">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="avatar-option" data-avatar="user-ninja" onclick="selectAvatar('user-ninja')">
                                        <i class="fas fa-user-ninja"></i>
                                    </div>
                                    <div class="avatar-option" data-avatar="user-tie" onclick="selectAvatar('user-tie')">
                                        <i class="fas fa-user-tie"></i>
                                    </div>
                                    <div class="avatar-option" data-avatar="user-astronaut" onclick="selectAvatar('user-astronaut')">
                                        <i class="fas fa-user-astronaut"></i>
                                    </div>
                                    <div class="avatar-option" data-avatar="user-secret" onclick="selectAvatar('user-secret')">
                                        <i class="fas fa-user-secret"></i>
                                    </div>
                                    <div class="avatar-option" data-avatar="robot" onclick="selectAvatar('robot')">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-group">
                                <label>Confidentialité</label>
                                <div class="privacy-settings">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="public-stats" checked>
                                        <label for="public-stats">Statistiques publiques</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="show-online" checked>
                                        <label for="show-online">Afficher le statut en ligne</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="allow-friend-requests" checked>
                                        <label for="allow-friend-requests">Autoriser les demandes d'amis</label>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-group">
                                <label>Actions</label>
                                <div class="profile-actions">
                                    <button onclick="resetStats()" class="danger-btn">
                                        <i class="fas fa-refresh"></i> Réinitialiser les statistiques
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="game-screen hidden">
                <div class="game-hud">
                    <div class="hud-top">
                        <div class="team-score">
                        <div class="team-score-item attackers">
                            <span class="team-name">Attaquants</span>
                            <span class="score" id="attackers-score">0</span>
                        </div>
                        <div class="game-info">
                            <div class="round-timer" id="round-timer">1:40</div>
                            <div class="round-info">
                                <span id="round-number">Round 1</span>
                                <span id="game-phase">Phase d'achat</span>
                            </div>
                        </div>
                        <div class="team-score-item defenders">
                            <span class="score" id="defenders-score">0</span>
                            <span class="team-name">Défenseurs</span>
                        </div>
                        </div>
                        <div class="spectator-controls">
                            <button id="spectator-toggle-btn" class="btn-ghost">
                                <i class="fas fa-eye"></i>
                                Mode spectateur
                            </button>
                        </div>
                    </div>

                    <div class="hud-bottom">
                    <div class="player-stats">
                        <div class="health-armor">
                            <div class="health">
                                <i class="fas fa-heart"></i>
                                <span id="player-health">100</span>
                            </div>
                            <div class="armor">
                                <i class="fas fa-shield-alt"></i>
                                <span id="player-armor">0</span>
                            </div>
                        </div>
                        <div class="weapon-info">
                            <div class="weapon-name" id="current-weapon">Classic</div>
                            <div class="ammo">
                                <span id="current-ammo">12</span> / <span id="total-ammo">36</span>
                            </div>
                        </div>
                        <div class="economy-info">
                            <div class="money">
                                <i class="fas fa-coins"></i>
                                <span id="player-money">800</span>
                            </div>
                            <div class="bomb-status" id="bomb-status"></div>
                        </div>
                    </div>

                    <!-- Abilities Display -->
                    <div class="abilities-hud" id="abilities-hud">
                        <div class="ability-slot" id="ability-c" data-key="C">
                            <div class="ability-icon">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' ry='12' fill='%23242a3a'/%3E%3Ctext x='32' y='36' text-anchor='middle' dominant-baseline='middle' font-family='Arial' font-size='30' fill='%23ffffff'%3E%3F%3C/text%3E%3C/svg%3E" alt="Icône capacité"/>
                            </div>
                            <div class="ability-key">C</div>
                            <div class="ability-cooldown" id="ability-c-cooldown">0</div>
                        </div>
                        <div class="ability-slot" id="ability-a" data-key="A">
                            <div class="ability-icon">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' ry='12' fill='%23242a3a'/%3E%3Ctext x='32' y='36' text-anchor='middle' dominant-baseline='middle' font-family='Arial' font-size='30' fill='%23ffffff'%3E%3F%3C/text%3E%3C/svg%3E" alt="Icône capacité"/>
                            </div>
                            <div class="ability-key">A</div>
                            <div class="ability-cooldown" id="ability-a-cooldown">0</div>
                        </div>
                        <div class="ability-slot ultimate" id="ability-x" data-key="X">
                            <div class="ability-icon">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' ry='12' fill='%23242a3a'/%3E%3Ctext x='32' y='36' text-anchor='middle' dominant-baseline='middle' font-family='Arial' font-size='30' fill='%23ffffff'%3E%3F%3C/text%3E%3C/svg%3E" alt="Icône capacité"/>
                            </div>
                            <div class="ability-key">X</div>
                            <div class="ability-points" id="ability-x-points">0/7</div>
                        </div>
                    </div>
                </div>

                <div class="minimap">
                    <canvas id="minimap-canvas" width="150" height="150"></canvas>
                    <div class="minimap-info">
                        <div class="map-name" id="minimap-map-name">Dust2</div>
                    </div>
                </div>

                <!-- Scoreboard (Tab to show) -->
                <div class="scoreboard hidden" id="scoreboard">
                    <div class="scoreboard-content">
                        <div class="scoreboard-header">
                            <h3>Tableau des scores</h3>
                            <div class="match-info">
                                <span id="scoreboard-mode">Compétitif</span> • 
                                <span id="scoreboard-map">Dust2</span>
                            </div>
                        </div>
                        <div class="teams-container">
                            <div class="team-section attackers">
                                <div class="team-header">
                                    <h4>Attaquants</h4>
                                    <div class="team-score-display" id="scoreboard-attackers-score">0</div>
                                </div>
                                <div class="scoreboard-headers">
                                    <span>Joueur</span>
                                    <span>K</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>Éco</span>
                                    <span>Ping</span>
                                </div>
                                <div class="players-list" id="attackers-list"></div>
                            </div>
                            <div class="team-section defenders">
                                <div class="team-header">
                                    <h4>Défenseurs</h4>
                                    <div class="team-score-display" id="scoreboard-defenders-score">0</div>
                                </div>
                                <div class="scoreboard-headers">
                                    <span>Joueur</span>
                                    <span>K</span>
                                    <span>D</span>
                                    <span>A</span>
                                    <span>Éco</span>
                                    <span>Ping</span>
                                </div>
                                <div class="players-list" id="defenders-list"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pause Menu -->
                <div id="pause-menu" class="pause-menu hidden">
                    <div class="pause-menu-content">
                        <h2>Menu de pause</h2>

                        <div class="pause-section">
                            <button id="pause-resume" class="btn-primary full-width">
                                <i class="fas fa-play"></i> Reprendre
                            </button>
                        </div>

                        <!-- Options d'entraînement (uniquement en mode training) -->
                        <div class="pause-section training-options hidden">
                            <h3><i class="fas fa-graduation-cap"></i> Entraînement</h3>
                            <label class="toggle-row">
                                <input type="checkbox" id="training-bots-moving" checked>
                                <span>Bots en mouvement</span>
                            </label>
                            <label class="toggle-row">
                                <input type="checkbox" id="training-bots-respawn" checked>
                                <span>Respawn automatique</span>
                            </label>
                            <label class="toggle-row">
                                <span>Nombre de bots</span>
                                <input type="number" id="training-bots-count" value="5" min="1" max="20">
                            </label>
                            <label class="toggle-row">
                                <input type="checkbox" id="training-infinite-money">
                                <span>Argent infini</span>
                            </label>
                            <label class="toggle-row">
                                <input type="checkbox" id="training-infinite-ammo">
                                <span>Munitions infinies</span>
                            </label>

                            <div class="training-stats">
                                <div><span>Kills</span><strong id="training-stats-kills">0</strong></div>
                                <div><span>Tirs</span><strong id="training-stats-shots">0</strong></div>
                                <div><span>Précision</span><strong id="training-stats-accuracy">0%</strong></div>
                            </div>

                            <div class="pause-buttons">
                                <button id="training-apply-settings" class="btn-primary">
                                    <i class="fas fa-sync"></i> Appliquer
                                </button>
                                <button id="training-reset-bots" class="btn-secondary">
                                    <i class="fas fa-redo"></i> Réinitialiser
                                </button>
                            </div>
                        </div>

                        <!-- Paramètres graphiques (toujours disponibles) -->
                        <div class="pause-section">
                            <h3><i class="fas fa-cog"></i> Paramètres</h3>
                            <label class="toggle-row">
                                <span>Afficher FPS</span>
                                <input type="checkbox" id="setting-show-fps">
                            </label>
                            <label class="toggle-row">
                                <span>Qualité graphique</span>
                                <select id="setting-graphics-quality" class="setting-select">
                                    <option value="low">Basse</option>
                                    <option value="medium" selected>Moyenne</option>
                                    <option value="high">Haute</option>
                                </select>
                            </label>
                            <label class="toggle-row">
                                <span>Sensibilité souris</span>
                                <input type="range" id="setting-mouse-sensitivity" min="1" max="20" value="10" step="1">
                                <span id="sensitivity-value">10</span>
                            </label>
                        </div>

                        <!-- Touches (toujours disponibles) -->
                        <div class="pause-section">
                            <h3><i class="fas fa-keyboard"></i> Touches</h3>
                            <div class="binding-list">
                                <div class="binding-row">
                                    <span>Capacité 1</span>
                                    <button class="binding-btn" data-action="ability1">C</button>
                                </div>
                                <div class="binding-row">
                                    <span>Capacité 2</span>
                                    <button class="binding-btn" data-action="ability2">A</button>
                                </div>
                                <div class="binding-row">
                                    <span>Ultimate</span>
                                    <button class="binding-btn" data-action="ultimate">X</button>
                                </div>
                                <div class="binding-row">
                                    <span>Planter / Désamorcer</span>
                                    <button class="binding-btn" data-action="plant">E</button>
                                </div>
                                <div class="binding-row">
                                    <span>Ramasser</span>
                                    <button class="binding-btn" data-action="pickup">F</button>
                                </div>
                                <div class="binding-row">
                                    <span>Ouvrir boutique</span>
                                    <button class="binding-btn" data-action="buyMenu">B</button>
                                </div>
                                <div class="binding-row">
                                    <span>Sprinter</span>
                                    <button class="binding-btn" data-action="sprint">Shift</button>
                                </div>
                                <div class="binding-row">
                                    <span>Pause</span>
                                    <button class="binding-btn" data-action="pause">Échap</button>
                                </div>
                            </div>
                        </div>

                        <div class="pause-section">
                            <button class="btn-secondary full-width" onclick="leaveGame()">
                                <i class="fas fa-door-open"></i> Quitter la partie
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Buy Menu Instructions -->
                <div class="buy-hint" id="buy-hint">
                    <div class="hint-content">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Appuyez sur <kbd>B</kbd> pour ouvrir la boutique</span>
                    </div>
                </div>

                <!-- Bomb Interaction Hint -->
                <div class="bomb-hint hidden" id="bomb-hint">
                    <div class="hint-content">
                        <i class="fas fa-bomb"></i>
                        <span id="bomb-hint-text">Appuyez sur <kbd>E</kbd> pour planter la spike</span>
                    </div>
                </div>

                <!-- Game Controls Help -->
                <div class="controls-help hidden" id="controls-help">
                    <div class="help-content">
                        <h4>Contrôles</h4>
                        <div class="controls-grid">
                            <div><kbd>WASD</kbd> Déplacement</div>
                            <div><kbd>Shift</kbd> Courir</div>
                            <div><kbd>Ctrl</kbd> S'accroupir</div>
                            <div><kbd>R</kbd> Recharger</div>
                            <div><kbd>B</kbd> Boutique</div>
                            <div><kbd>4</kbd> Spike/Désamorcer</div>
                            <div><kbd>Tab</kbd> Score</div>
                            <div><kbd>Esc</kbd> Menu</div>
                        </div>
                    </div>
                </div>
            </div>

            <canvas id="game-canvas" width="1200" height="800"></canvas>

            <div class="spectator-overlay hidden" id="spectator-overlay">
                <div class="spectator-panel">
                    <h3><i class="fas fa-eye"></i> Mode spectateur</h3>
                    <p>Déplacez-vous avec <strong>ZQSD</strong> ou les flèches. Maintenez <strong>Shift</strong> pour accélérer.</p>
                    <p>Activez/Désactivez avec le bouton ou la touche <strong>F3</strong>.</p>
                </div>
            </div>

            <div class="game-menu-overlay hidden" id="game-menu-overlay">
                <div class="game-menu">
                    <h3>Menu de jeu</h3>
                    <button onclick="resumeGame()"><i class="fas fa-play"></i> Reprendre</button>
                    <button onclick="toggleControlsHelp()"><i class="fas fa-keyboard"></i> Contrôles</button>
                    <button onclick="showSettings()"><i class="fas fa-cog"></i> Paramètres</button>
                    <button onclick="leaveGame()" class="danger"><i class="fas fa-sign-out-alt"></i> Quitter la Partie</button>
                </div>
            </div>

            <!-- Buy Menu -->
            <div class="buy-menu-overlay hidden" id="buy-menu-overlay">
                <div class="buy-menu">
                    <div class="buy-menu-header">
                        <h3><i class="fas fa-shopping-cart"></i> Boutique d'armes</h3>
                        <div class="player-money">
                            <i class="fas fa-coins"></i>
                            <span id="buy-menu-money">800</span>
                        </div>
                        <button class="close-buy-menu" onclick="closeBuyMenu()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="buy-menu-content">
                        <div class="buy-category">
                            <h4>Pistolets</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyWeapon('classic', 0)">
                                    <div class="weapon-icon">🔫</div>
                                    <div class="weapon-name">Classic</div>
                                    <div class="weapon-price">Gratuit</div>
                                </div>
                                <div class="weapon-item" onclick="buyWeapon('sheriff', 800)">
                                    <div class="weapon-icon">🔫</div>
                                    <div class="weapon-name">Sheriff</div>
                                    <div class="weapon-price">800</div>
                                </div>
                            </div>
                        </div>
                        <div class="buy-category">
                            <h4>SMG</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyWeapon('spectre', 1600)">
                                    <div class="weapon-icon">🔫</div>
                                    <div class="weapon-name">Spectre</div>
                                    <div class="weapon-price">1600</div>
                                </div>
                            </div>
                        </div>
                        <div class="buy-category">
                            <h4>Fusils</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyWeapon('phantom', 2900)">
                                    <div class="weapon-icon">🔫</div>
                                    <div class="weapon-name">Phantom</div>
                                    <div class="weapon-price">2900</div>
                                </div>
                                <div class="weapon-item" onclick="buyWeapon('vandal', 2900)">
                                    <div class="weapon-icon">🔫</div>
                                    <div class="weapon-name">Vandal</div>
                                    <div class="weapon-price">2900</div>
                                </div>
                            </div>
                        </div>
                        <div class="buy-category">
                            <h4>Sniper</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyWeapon('operator', 4700)">
                                    <div class="weapon-icon">🎯</div>
                                    <div class="weapon-name">Operator</div>
                                    <div class="weapon-price">4700</div>
                                </div>
                            </div>
                        </div>
                        <div class="buy-category">
                            <h4>Armure</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyArmor('light', 400)">
                                    <div class="weapon-icon">🛡️</div>
                                    <div class="weapon-name">Armure légère</div>
                                    <div class="weapon-price">400</div>
                                </div>
                                <div class="weapon-item" onclick="buyArmor('heavy', 1000)">
                                    <div class="weapon-icon">🛡️</div>
                                    <div class="weapon-name">Armure lourde</div>
                                    <div class="weapon-price">1000</div>
                                </div>
                            </div>
                        </div>
                        <div class="buy-category">
                            <h4>Capacités</h4>
                            <div class="weapon-grid">
                                <div class="weapon-item" onclick="buyAbility('ability1', 300)" id="buy-ability1">
                                    <div class="weapon-icon">⚡</div>
                                    <div class="weapon-name">Capacité 1 (C)</div>
                                    <div class="weapon-price">300</div>
                                </div>
                                <div class="weapon-item" onclick="buyAbility('ability2', 400)" id="buy-ability2">
                                    <div class="weapon-icon">💥</div>
                                    <div class="weapon-name">Capacité 2 (A)</div>
                                    <div class="weapon-price">400</div>
                                </div>
                            </div>
                            <div class="ability-note" style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px; font-size: 12px; color: rgba(255,255,255,0.7);">
                                <i class="fas fa-info-circle"></i> Les capacités se rechargent automatiquement après utilisation
                            </div>
                        </div>
                    </div>
                    <div class="buy-menu-footer">
                        <p>Phase d'achat: <span id="buy-time-remaining">30</span>s</p>
                        <p class="help-text">Appuyez sur <kbd>B</kbd> ou <kbd>Esc</kbd> pour fermer</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Case Opening Modal -->
    <div id="case-opening-modal" class="modal-overlay hidden">
        <div class="case-opening-container">
            <div class="case-opening-header">
                <h2 id="case-opening-title">Ouverture de Case</h2>
                <button class="modal-close" onclick="closeCaseOpeningModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="case-opening-animation">
                <div class="case-display">
                    <div class="case-image" id="case-image"></div>
                </div>
                <div class="opening-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="opening-progress"></div>
                    </div>
                </div>
                <div class="skin-reveal hidden" id="skin-reveal">
                    <div class="skin-card">
                        <div class="skin-image" id="revealed-skin-image"></div>
                        <div class="skin-info">
                            <div class="skin-name" id="revealed-skin-name"></div>
                            <div class="skin-weapon" id="revealed-skin-weapon"></div>
                            <div class="skin-rarity" id="revealed-skin-rarity"></div>
                        </div>
                    </div>
                </div>
                <div class="opening-actions hidden" id="opening-actions">
                    <button class="btn-primary" onclick="equipSkin()">Équiper</button>
                    <button class="btn-secondary" onclick="closeCaseOpeningModal()">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <!-- Game Scripts -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script src="profile.js"></script>
    <script src="matchmaking.js"></script>
    <script src="agents.js"></script>
    <script src="battlepass.js"></script>
    <script src="tournament.js"></script>
    <script src="spectator.js"></script>
    <script src="menu.js"></script>
    <script src="gameplay.js"></script>
    <script src="game.js"></script>
    <script src="utils.js"></script>
    <script src="store.js"></script>

    <!-- Additional Functions -->
    <script>
        function toggleControlsHelp() {
            const help = document.getElementById('controls-help');
            help.classList.toggle('hidden');
        }

        function showBuyHint() {
            const hint = document.getElementById('buy-hint');
            hint.style.display = 'block';
            setTimeout(() => {
                hint.style.display = 'none';
            }, 5000);
        }

        // Show buy hint at start of buy phase
        function onBuyPhaseStart() {
            showBuyHint();
        }
    </script>
</body>
</html>
